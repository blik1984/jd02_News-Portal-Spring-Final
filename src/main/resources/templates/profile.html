<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
<head>
<meta charset="UTF-8" />
<title>NewsPortal – Личный кабинет</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<!-- Bootstrap -->
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
	rel="stylesheet">
<!-- Bootstrap Icons -->
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">

<style>
.header-top {
	background-color: #f1f1f1;
	padding: 10px 0;
}

footer {
	background-color: #f8f9fa;
	padding: 20px 0;
	margin-top: 40px;
	text-align: center;
}
</style>
</head>
<body>

	<!-- ===== HEADER ===== -->
	<header class="header-top">
		<div
			class="container d-flex justify-content-between align-items-center">
			<a href="/" class="text-dark text-decoration-none fs-4 fw-bold">NewsPortal</a>
			<div class="d-flex align-items-center">
				<span class="me-3">Привет, <b th:text="${user.name}">User</b>!
				
				<form th:action="@{/logout}" method="post" style="display: inline">
					<button class="btn btn-sm btn-outline-danger">Выход</button>
				</form>
			</div>
		</div>
	</header>

	<!-- ===== CONTENT ===== -->
	<main class="container mt-4">
		<h3 class="mb-4">
			<i class="bi bi-person-circle"></i> Личный кабинет
		</h3>

		<!-- Сообщения об успехе или ошибке -->
		<div th:if="${successMessage}" class="alert alert-success"
			th:text="${successMessage}"></div>
		<div th:if="${errorMessage}" class="alert alert-danger"
			th:text="${errorMessage}"></div>

		<div class="row">

			<!-- ===== РЕДАКТИРОВАНИЕ ПРОФИЛЯ ===== -->
			<div class="col-md-6">
				<div class="card">
					<div class="card-header">
						<i class="bi bi-pencil"></i> Личные данные
					</div>
					<div class="card-body">
						<form th:action="@{/user/update_profile}" method="post"
							th:object="${user}">
							<input type="hidden" th:name="${_csrf.parameterName}"
								th:value="${_csrf.token}" />

							<div class="mb-3">
								<label class="form-label">Имя</label> <input
									class="form-control" th:field="*{name}" required />
							</div>

							<div class="mb-3">
								<label class="form-label">Фамилия</label> <input
									class="form-control" th:field="*{surname}" />
							</div>

							<div class="mb-3">
								<label class="form-label">Дата рождения</label> <input
									type="date" class="form-control" th:field="*{dateOfBirthday}" />
							</div>

							<button class="btn btn-primary">
								<i class="bi bi-save"></i> Сохранить изменения
							</button>
						</form>
					</div>
				</div>
			</div>

			<!-- ===== ИНФОРМАЦИЯ АККАУНТА ===== -->
			<div class="col-md-6">
				<div class="card">
					<div class="card-header">
						<i class="bi bi-shield-lock"></i> Информация аккаунта
					</div>
					<div class="card-body">
						<table class="table table-bordered mb-0">
							<tr>
								<th>Email</th>
								<td th:text="${user.email}"></td>
							</tr>
							<tr>
								<th>Роль</th>
								<td><span class="badge"
									th:class="${user.role.name() == 'ADMIN'} ? 'bg-danger' : 'bg-primary'"
									th:text="${user.role}"></span></td>
							</tr>
							<tr>
								<th>Статус</th>
								<td><span th:if="${user.activ != null and user.activ}"
									class="badge bg-success">Активный</span> <span
									th:if="${user.activ == null or not user.activ}"
									class="badge bg-secondary">Заблокирован</span></td>
							</tr>
							<tr>
								<th>Автор</th>
								<td><span th:if="${user.author != null and user.author}"
									class="badge bg-success">Да</span> <span
									th:if="${user.author == null or not user.author}"
									class="badge bg-secondary">Нет</span></td>
							</tr>

							<tr>
								<th>Дата регистрации</th>
								<td th:text="${user.registrationDate}"></td>
							</tr>
						</table>
					</div>
				</div>
			</div>

		</div>
	</main>

	<!-- ===== FOOTER ===== -->
	<footer>
		<div class="container">
			<p class="mb-0">
				© 2025 NewsPortal. Все права защищены. | <a href="/page_privacy">Политика
					конфиденциальности</a>
			</p>
		</div>
	</footer>

	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
